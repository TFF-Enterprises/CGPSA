<?xml version="1.1" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "xhtml11.dtd">
<!-- $Id$ -->
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<title>CGPSA - A Spam Filter for CommuniGate&reg; Pro</title>
<link rel="stylesheet" href="style.css" type="text/css" media="screen" />
</head>
<body>
<h1>CGPSA - A Spam Filter for <a href="http://www.stalker.com/CommuniGatePro/">CommuniGate&reg; Pro</a><br/>Version 1.2.4</h1>
<h2>Copyright &copy; 2002-2003 TFF Enterprises<br/>
Written by <a href="http://www.tffenterprises.com/~dmz/">Daniel M. Zimmerman</a><br/>
All Rights Reserved</h2>

<p>CGPSA works in concert with <a
href="http://www.spamassassin.org/">SpamAssassin</a>&trade; software
to scan email messages distributed by a <a
href="http://www.stalker.com/CommuniGatePro/">CommuniGate&reg;
Pro</a> server. The filter works efficiently, by directly using
the SpamAssassin API. It does not rely on a daemon process such as
spamd or on the execution of shell scripts (as the usual process for
utilizing SpamAssassin with CommuniGate servers does). It can safely
be used with multiple CommuniGate Pro enqueuer threads.</p>

<p>CGPSA supports all features of SpamAssassin, including such
functionality as the use of <a
href="http://razor.sourceforge.net/">Razor</a>, <a
href="http://www.rhyolite.com/anti-spam/dcc/">DCC</a>, Bayesian
learning, and auto-whitelists. All these features are controlled through
SpamAssassin's regular configuration files. For more information on
SpamAssassin features and configuration, see the SpamAssassin <a
href="http://www.spamassassin.org/doc.html">documentation</a>.</p>

<h3>Downloads</h3>
<p>The most current (release) version of CGPSA can always be downloaded
from <a href="http://www.tffenterprises.com/cgpsa/cgpsa.tgz">
http://www.tffenterprises.com/cgpsa/cgpsa.tgz</a>. The current (release) 
version is
<a
href="http://www.tffenterprises.com/cgpsa/releases/cgpsa-1_2_4.tgz">1.2.4</a>,
released ?? ?? 2003. There is currently no beta release
available.</p>

<h2>Documentation</h2>

<p>This documentation consists of the following sections:</p>

<ul>
<li><a href="#overview">Overview</a></li>
<li><a href="#requirements">System Requirements</a></li>
<li><a href="#installation">Installation</a></li>
<li><a href="#upgrading">Upgrading</a></li>
<li><a href="#license">License and Fees</a></li>
<li><a href="#bugs">Bugs Reports, Feature Requests and the Like</a></li>
<li><a href="#history">Revision History</a></li>
<li><a href="#future">Future Plans</a></li>
<li><a href="#legal">Legal Stuff</a></li>
</ul>

<hr/>

<h3 id="overview">Overview</h3>

<p>CGPSA has two basic operating modes, "<a
href="#overview:fullfeatured">full-featured</a>" and "<a
href="#overview:headersonly">headers-only</a>".</p>

<h4 id="overview:fullfeatured">Full-Featured Mode</h4>

<p>Full-featured mode uses CommuniGate Pro's PIPE functionality to
resubmit messages to the server after scanning, and can also use the
CommuniGate Pro CLI to determine information about message
recipients. In this mode, email is scanned only for the recipients on
the local system, and email for remote systems is always left
unaltered. This is good, because SpamAssassin headers added according
to your local policy may interfere with the spam filtering policy of a
remote system. If a particular message is destined for both local and
remote users, the local users receive a scanned copy and the remote
users an unaltered one. Scanned email is treated exactly as
SpamAssassin would treat it; for instance, if the SpamAssassin
preferences say to rewrite the subject line of spam, a scanned spam
will have a rewritten subject line. </p>

<p>Other advanced functionality, such as the use of individual
SpamAssassin preference files and state files for particular users
(e.g. auto-whitelist, Bayes database), is available in full-featured
mode. At this time, there is no user interface to configure individual
SpamAssassin preferences; however, system administrators with access
to the CommuniGate Pro directory may take advantage of these features
for their own use. Individual user preferences are located in a
<code>.spamassassin</code> directory inside the web directory corresponding
to the account (<code>username.macnt/account.web</code>).</p>


<h4 id="overview:headersonly">Headers-Only Mode</h4>

<p>Headers-only mode does not use CommuniGate Pro's CLI or PIPE
functionality. Instead, it adds headers to messages directly through
CommuniGate's external filter interface. This has the benefit of being
more efficient than using PIPE, because it does not require
resubmission and reprocessing of messages. However, it also eliminates
much of the advanced functionality, such as the use of individual
preference and state files, and the ability to distribute unaltered
messages to remote servers.</p>

<hr/>

<h3 id="requirements">System Requirements</h3>

<p>CGPSA requires the following in order to run:</p>
<ol>
<li>CommuniGate Pro version 4.0 or higher (4.1 or higher preferred)</li>
<li>Perl version 5.6.0 or higher (5.6.1 or higher preferred)</li>
<li><a href="http://www.spamassassin.org/">SpamAssassin</a> version 2.5 or higher</li>
<li>Additional Perl modules as required by the configuration options you 
choose for CGPSA and SpamAssassin (described in the installation steps 
below and in SpamAssassin's documentation).</li>
</ol>

<hr/>

<h3 id="installation">Installation</h3>

<p>Installation of CGPSA takes several steps. The following step-by-step
instructions should enable you to get the filter working on your system
(there are special instructions for Win32 systems throughout the steps).
If you can't get it working, ask for help (as described below in <a
href="#bugs">Bug Reports, Feature Requests and the Like</a>).</p>

<ol>

<li>Install <a href="http://www.spamassassin.org/">SpamAssassin</a> on
your system. The way to do this is platform dependent - on FreeBSD, for
example, you might use the FreeBSD Ports system. Also install any
auxiliary programs you want SpamAssassin to use, such as Razor and DCC.
<a href="http://www.cpan.org/">Perl</a> is a prerequisite for
SpamAssassin. Instructions for installing SpamAssassin on Win32
operating systems are available <a
href="http://www.openhandhome.com/howtosa250.html">here</a>. On Win32,
you must add <code>RES_NAMESERVERS</code> to your system environment
variables to enable DNS lookups under Perl (this is discussed in the
installation instructions for SpamAssassin).<br/><br/></li>

<li>Verify that the path in the first line of the <code>cgpsa</code>
script points to the Perl executable on your system. If you have Perl
in a different location (such as <code>/usr/local/bin/perl</code> or
<code>/opt/bin/perl</code>), change the line accordingly. On Win32, this step is not required.<br/><br/></li>

<li>Verify that the <code>$cgp_base</code> variable (listed under
"Customizable Variables" near the top of the <code>cgpsa</code>
script) contains the correct path to your CommuniGate Pro Base
Directory (hereafter referred to as "CommuniGate directory"). The
default path is <code>/var/CommuniGate</code> on most systems. On Win32, specify the location with a drive letter, using forward slashes (not backslashes) as separators: for example, <code>C:/CommuniGate Files/</code> (the default base directory on Win32).<br/><br/></li>

<li>Install the <code>cgpsa</code> script inside your CommuniGate
directory, and make sure it is executable. You can create a new
subdirectory for it, or just put it at the top level; it doesn't really
matter where it is, but make sure you know the full path to it
(<code>/var/CommuniGate/cgpsa</code>, if it is at the top level of a
default CommuniGate directory on UNIX) - you'll need the path
later.<br/><br/></li>

<li>Install the <code>cgpsa.conf</code> configuration file into the
<code>Settings</code> subdirectory of your CommuniGate directory. Modify
any of the settings you want to change - they are all well documented in
the configuration file itself.<br/><br/></li>

<li>If you are running CGPSA in its full-featured mode with CLI usage
enabled, you must install the <a
href="http://www.stalker.com/CGPerl/">CommuniGate Pro CLI Perl
Module</a>, <code>CLI.pm</code>. A version of <code>CLI.pm</code> is
included with the CGPSA distribution. You can copy it to any of your
system's Perl @INC directories, or just place it in the directory where
you've installed <code>cgpsa</code>. <code>CLI.pm</code> requires the <a
href="http://search.cpan.org/search?module=Digest::MD5">Digest::MD5</a>
Perl module; if you do not have it installed on your system, download
and install it (or use the <a href="http://www.cpan.org/">CPAN</a>
module to install it). If you have installed other scripts on your
system that require the CommuniGate Pro CLI, you may already have
installed <code>CLI.pm</code>; you do not need to reinstall it for
CGPSA, though you should ensure that it's a recent version. If you are
running in headers-only mode, or in full-featured mode without the CLI,
you need not install <code>CLI.pm</code> for CGPSA to
function.<br/><br/></li>

<li>If you are running CGPSA in its full-featured mode with CLI usage
enabled, you must create a CommuniGate Pro account with PWD access (as
described in the configuration file). Use the username and password
specified in your <code>cgpsa.conf</code>. This user must have
administrative access to all the domains for which you will be using
CGPSA (the easiest way to do this is to give it access to modify all
settings and privileges). Enable a number of PWD connections
greater than the number of enqueuer threads used by your server. See the
configuration file for details. If you are running in headers-only mode,
or in full-featured mode without the CLI, you need not create an account
for PWD access.<br/><br/></li>

<li>If you are running CGPSA in its full-featured mode with CLI usage
enabled, and your CommuniGate Pro setup has IP addresses specifically
assigned to domains, make sure that either you have specified
"127.0.0.1" as an address associated with one of your domains or you
have changed the "cgp_hostname" setting in <code>cgpsa.conf</code> to
refer to a hostname or IP address on which the CommuniGate server is
listening.<br/><br/></li>

<li>Create the "default home directory", whose path is set in the
configuration file (<code>cgpsa.conf</code>). This is where the default
SpamAssassin preferences and state files will be stored - that is, those
that are used in the absence of individual user
preferences.<br/><br/></li>

<li>Create a SpamAssassin configuration in the default home directory,
if necessary. If the CommuniGate Pro server is the only software on your
system using SpamAssassin, you can just use SpamAssassin's
<code>local.cf</code> file (usually in
<code>/etc/mail/spamassassin/</code>) to set up SpamAssassin's
preferences. Otherwise, create a <code>.spamassassin</code> subdirectory
inside the default home directory, containing a <code>user_prefs</code>
file with the SpamAssassin preferences to be used by
CGPSA.<br/><br/></li>

<li>In the CommuniGate Pro web administration interface, go to the
"Helper Settings" page (under "Settings/General"). In an empty "Content
Filtering" section, enter a name for the filter (such as "CGPSA"). For
the Program Path on UNIX, enter the full path to the filter (example:
<code>/var/CommuniGate/cgpsa</code> - see step 4). For the Program Path
on Win32, enter <code>perl</code> followed by the full path to the
filter (example: <code>perl C:/CommuniGate Files/cgpsa</code>. Set the
Log level to "Low Level" or "All Info" (for now). Leave "Time-out" and
"Auto-Restart" set to "Disabled" unless you experience problems with the
filter (be optimistic for the time being). Finally, enable the filter
and save your changes.<br/><br/></li>

<li>Examine the CommuniGate Pro log for the current day, and search
for the string you entered as the filter's name in the previous
step. You should see a line that reads similar to the following: "*
TFF Enterprises CGPSA Filter (Version) Ready". If you do not see this line,
wait a few seconds and look again. If you still do not see it after a
minute or so, something went wrong and there will likely be an error
message in the log. If you can make sense of it and fix the problem,
wonderful; if not, ask for help (as described below in <a
href="#bugs">Bug Reports, Feature Requests and the
Like</a>).<br/><br/></li>

<li>Go to the "Server-Wide Rules" page of the CommuniGate Pro web
administration interface ("Settings/Rules") and create a rule for
CGPSA.  The rule action should be "ExternalFilter CGPSA" (the name you
assigned to the filter two steps ago).  No rule conditions are
necessary for proper operation, but greater efficiency will be
attained with the following conditions: "Any Route is LOCAL*" and
"Header Field is not X-TFF-CGPSA-Filter*" (or whatever you've changed
the loop prevention header to). Note that omitting the first of these
conditions means that mail distributed to remote servers will be
scanned (which may not be a good idea - in full-featured mode with the CLI, CGPSA will automatically leave mail for remote servers alone, but in other modes, it scans every message passed to it).</li>

</ol>

<p>If all went well, CGPSA is running and you're done. Send a test
message to yourself and examine its headers to see whether it has been
scanned. You may want to change the log level after running CGPSA for
a while, because it does generate quite a lot of output (it's pretty
interesting output, but if you aren't writing/debugging the filter,
much of it isn't too useful).</p>

<hr/>

<h3 id="upgrading">Upgrading</h3>

<p>To upgrade from a previous version of CGPSA, perform the following steps:</p>

<ol>

<li>Copy the new <code>cgpsa</code> and <code>CLI.pm</code> over the
ones you currently have installed.<br/><br/></li>

<li>Compare the configuration file (<code>cgpsa.conf</code>) that came
with the new CGPSA to the configuration file you currently have
installed. If there are any new configuration options that you want to
use, add them to your installed configuration file. Alternatively, you
can add your own customizations to the new configuration file and copy
it over the old one.<br/><br/></li>

<li>In the CommuniGate Pro web administration interface, go to the
"Helper Settings" page (under "Settings/General"). In the "Content
Filtering" section you made for CGPSA, uncheck the checkbox by "Use
Filter", and then click "Update". Then, re-check the checkbox by "Use
Filter" and click "Update" again.<br/><br/></li>

<li>Examine the CommuniGate Pro log for the current day. You should see
a line that reads "* TFF Enterprises CGPSA Filter (Old Version Number)
Done", and slightly later a line that reads "* TFF Enterprises CGPSA
Filter (New Version Number) Ready". If you don't see this, and it
doesn't show up after a reasonable amount of time, restart your
CommuniGate server (using the startup/shutdown script installed with
CommuniGate). If CGPSA still doesn't start, ask for help (as described
below in <a href="#bugs">Bug Reports, Feature Requests and the
Like</a>).<br/><br/></li>

</ol>

<hr/>

<h3 id="disclaimer">Disclaimer</h3>

<p>It is possible that CGPSA contains bugs, although it has already been
in use for months in production systems and we consider it relatively
stable. Any bugs that might exist in CGPSA are unlikely to cause the
loss of email, because CommuniGate Pro is very intelligent about how it
works with external filters - when a filter fails, the message stays
enqueued. However, it is <em>possible</em> that email could be lost.
There is no warranty, express or implied, associated with CGPSA; we will
not be liable for any lost email. Use at your own risk.</p>

<hr/>

<h3 id="license">License and Fees</h3>

<p>The final licensing model for CGPSA has not been determined. It has
very similar functionality to some existing commercial products, and
significant effort has been put into it; it would thus be good to
receive something in return. However, charging licensing fees even
remotely similar to those charged for the aforementioned products
makes no sense. Currently, I'm leaning toward some sort of
shareware/donationware model. If you have any suggestions in this
regard (i.e., how much is the filter worth to you?), let me know.</p>

<p>In the meantime, CGPSA is not to be redistributed without explicit
permission. Its source code may not be used in any other products,
in verbatim or modified form, whether or not the product is
open-source. You may of course modify the source code in any way you
like for use on your own system.</p>

<hr/>

<h3 id="bugs">Bug Reports, Feature Requests, and the Like</h3>

<p>Suggestions for feature improvements and bug fixes will gladly be
accepted. There is a mailing list for discussion about this filter,
<code>cgpsa-discuss@tffenterprises.com</code>; this mailing list is
the primary channel for support, discussion of feature requests and
bug fixes, etc. It's a standard CGP mailing list: you can join it by
emailing <a
href="mailto:cgpsa-discuss-on@tffenterprises.com">cgpsa-discuss-on@tffenterprises.com</a>. I
expect it to be pretty low traffic; if you don't want to join the
list, though, send any questions, comments, rants, etc. to <a
href="mailto:cgpsa@tffenterprises.com">cgpsa@tffenterprises.com</a>.</p>

<p>When sending a bug report, be sure to include any relevant information
from the CommuniGate Pro log and the <code>cgpsa.err</code> log (located
in the same directory as your <code>cgpsa.conf</code> file).</p>

<hr/>

<h3 id="history">Revision History</h3>

<dl>
<dt><a href="http://www.tffenterprises.com/cgpsa/releases/cgpsa-1_2_4.tgz">1.2.4</a> - ?? ?? 2003</dt>
<dd>
<p>Changes</p>
<ul>
<li>Added a configuration option to turn on SpamAssassin's internal 
debugging (it is off by default).</li>
</ul>
</dd>
<dt><a href="http://www.tffenterprises.com/cgpsa/releases/cgpsa-1_2_3.tgz">1.2.3</a> - 14 November 2003</dt>
<dd>
<p>Bug Fixes</p>
<ul>
<li>Removed an unintentional dependency on Time::HiRes that was introduced 
in version 1.2.2 (and caused CGPSA to crash).</li>
</ul>
</dd>
<dt><a href="http://www.tffenterprises.com/cgpsa/releases/cgpsa-1_2_2.tgz">1.2.2</a> - 14 November 2003</dt>
<dd>
<p>Changes</p>
<ul>
<li>Added configuration options for specifying the install prefix,
system rules directory, and custom rules directory for SpamAssassin.
This should allow CGPSA to work properly, without hackery such as
duplicating entire directory trees, on systems such as Win32 where
current versions of SpamAssassin do not seem to correctly compile paths
into SpamAssassin.pm.</li>
<li>Added code to use Time::HiRes, if present, to give more accurate timing
for SpamAssassin processing.</li>
<li>Perl 5.6.1 is now required to use CGPSA. This prevents various bugs
in Perl 5.6.0 from affecting CGPSA's text processing.</li> 
</ul>
<p>Bug Fixes</p>
<ul>
<li>Fixed an issue where pathnames with spaces could not be used in the
cgpsa.conf file (this was especially problematic for Windows
users).</li>
</ul>
</dd>
<dt><a href="http://www.tffenterprises.com/cgpsa/releases/cgpsa-1_2_1.tgz">1.2.1</a> - 2 October 2003</dt>
<dd>
<p>Bug Fixes</p>
<ul>
<li>Fixed an issue where we inserted a duplicate X-Spam-Checker-Version header under SpamAssassin 2.6 in headers-only mode.</li>
<li>Fixed an issue where we sometimes, while trying to get rid of SpamAssassin headers from other servers, ended up duplicating our own SpamAssassin headers.</li>
</ul>
</dd>
<dt><a href="http://www.tffenterprises.com/cgpsa/releases/cgpsa-1_2.tgz">1.2</a> - 17 September 2003</dt>
<dd>
<p>Changes</p>
<ul>
<li>Perl 5.6.0 or higher is now required to run CGPSA (this was
unintentionally the case before, but CGPSA will die with a much more 
intuitive message now)</li>
<li>SpamAssassin 2.5 or higher is now required to run CGPSA.</li>
<li>The "max_requests" configuration option, which causes CGPSA to kill
itself after processing a certain number of requests (to help combat memory
leaks on systems where "parallel_requests" can't be used), has been
added.</li>
<li>Spurious X-Spam-* headers (that is, those added by SpamAssassin
running on other servers) are now removed from messages when running in
full-featured mode.</li>
<li>Headers-only mode has been made compatible with SpamAssassin 2.60 series
releases.</li>
<li>"\e" has replaced "\n" as the line separator in headers constructed by
CGPSA.</li>
</ul>
<p>Known Issues</p>
<ul>
<li>Same as for Version 1.1.</li>
</ul>
</dd>
<dt><a href="http://www.tffenterprises.com/cgpsa/releases/cgpsa-1_1.tgz">1.1</a> - 27 July 2003</dt>
<dd>
<p>Changes</p>
<ul>
<li>Parallel requests mode is now turned on by default on non-Windows 
platforms.</li>
<li>Modified the processing of message headers to preserve more 
information about the Envelope-To addresses.</li>
<li>Added the ability to specify a list of destination domains that should 
always have their mail scanned, with the "scan_domains" setting. This makes 
it possible to use CGP as a relay/gateway server (to filter and process 
email for other domains).</li>
<li>Added date/time stamp to the standard error output generated by
CGPSA. Output generated by other Perl code (such as SpamAssassin) is not
date/time stamped.</li>
<li>Changed CGPSA's output functions to wrap lines to a reasonable number of
characters (around 150), to work around the CommuniGate log line length 
limit.</li>
<li>Added signal handling: if the main CGPSA process receives a HUP, it 
reloads all of its own and SpamAssassin's preferences before processing
the next CLI command it receives.</li>
<li>Partially worked around the behavior whereby, when parallel_requests is 
off and use_user_prefs is on, users' SpamAssassin preferences get "stacked" 
on top of each other. Now, the SpamAssassin preferences in the default home 
directory are loaded before each set of user preferences, so they are 
"stacked" on top of the user prefs; this means that, if the default 
preferences file contains explicit settings for every parameter changed in a 
user preference file, SpamAssassin will return to these defaults between 
users.</li>
<li>Worked around SpamAssassin's problem with extremely large messages, by
only scanning the first 250K of each message.</li>
<li>Changed the location of the per-user configurations used by CGPSA (old 
configurations will automatically be moved to the new location).</li>
</ul>
<p>Known Issues</p>
<ul>
<li>If CGPSA has to truncate a message in order to scan it, that message
will almost definitely trigger the SpamAssassin rule
"MIME_MISSING_BOUNDARY". This probably won't cause non-spam messages to
cross the spam threshold, but it is a possibility.</li>
<li>When CGPSA catches a HUP signal and reloads its preferences, it leaks
some memory (as a result of the old SpamAssassin, or parts thereof, not 
going away). This cannot be fixed with the current version of SpamAssassin;
work is underway on a patch to SpamAssassin to enable a fix.</li>
<li>Entries in the CGP log that are line-wrapped have "\t" as their leading
character when CGPSA is used with Perl earlier than 5.8. This is a result of
limitations in the older Text::Wrap code.</li>
</ul>
</dd>
<dt><a href="http://www.tffenterprises.com/cgpsa/releases/cgpsa-1_0_8.tgz">1.0.8</a> - 18 June 2003</dt>
<dd>
<p>Bug Fixes</p>
<ul>
<li>Fixed an issue with the generation of random filenames that could have, 
on certain systems, resulted in message loss when using parallel 
requests.</li>
</ul>
</dd>
<dt><a href="http://www.tffenterprises.com/cgpsa/releases/cgpsa-1_0_7.tgz">1.0.7</a> - 17 June 2003</dt>
<dd>
<p>Changes</p>
<ul>
<li>Added the ability to use per-user preferences in either the old
location (the user's account directory) or the new location (the user's
"account.web" directory). This is primarily so that users of the 1.1 betas
can have a stable version to revert to without manually moving preferences
back and forth.</li>
</ul>
<p>Bug Fixes</p>
<ul>
<li>Fixed a bug where mail for "all@" and "alldomains@" addresses could have 
been delivered when it shouldn't have been. Mail to "all@" and "alldomains@"
addresses is now scanned in ADDHEADER mode, to preserve CGP's security
model for such mail.</li>
</ul>
</dd>
<dt><a href="http://www.tffenterprises.com/cgpsa/releases/cgpsa-1_0_6.tgz">1.0.6</a> - 5 May 2003</dt>
<dd>
<p>Changes</p>
<ul>
<li>Added an option (turned on by default) to redirect SpamAssassin's
error output to a file rather than to standard error. This solves a
problem that would cause the filter to hang on certain operating
systems (including Mac OS X).</li>
<li>Added information to log output about the paths to the SpamAssassin 
settings files being used; the path to the default settings file is output
at filter startup time, and the paths to user settings files are output
when those files are used.</li>
</ul>
<p>Bug Fixes</p>
<ul>
<li>Fixed a race condition where CGPSA would check for the ability
to connect to the CLI before the CommuniGate server was ready to accept
connections to the PWD port.</li>
<li>Fixed the entry for "default_home_dir" in the configuration file to
accurately reflect its default value.</li>
</ul>
</dd>
<dt><a href="http://www.tffenterprises.com/cgpsa/releases/cgpsa-1_0_5.tgz">1.0.5</a> - 14 April 2003</dt>
<dd>
<p>Changes</p>
<ul>
<li>Added some extra debugging output in various places, including 
printing of the preferences file location and the SpamAssassin version
at startup.</li>
<li>Added support for the new "Route Mail" CLI command option (for 
CommuniGate 4.1b3 and higher; compatibility is auto-detected).</li>
</ul>
<p>Bug Fixes</p>
<ul>
<li>Fixed a problem where mail to the "all@" and "alldomains" 
addresses would be bounced because of routing errors.</li>
<li>Fixed a problem where CGPSA would use root's home directory to 
store SpamAssassin state files in certain configurations.</li>
<li>Fixed a problem where the "cgp_hostname" setting was not being 
read from the configuration file.</li>
</ul>
</dd>
<dt><a href="http://www.tffenterprises.com/cgpsa/releases/cgpsa-1_0_4.tgz">1.0.4</a> - 2 April 2003</dt>
<dd>
<p>Changes</p>
<ul>
<li>Added the "use_c_locale" configuration option, to force the C locale to be used by Perl when running SpamAssassin (which has some known problems with certain locales). The default is to use the C locale.</li>
<li>Added more logic to the headers-only mode, so that we now produce the same headers as SpamAssassin would if it were rewriting the message itself.</li>
<li>Changed the text of the loop prevention header to read either "Scanned" or "Scan Failed", as appropriate (rather than "Attempted").</li>
<li>Fixed a problem that occurred with SpamAssassin's "report_safe" option turned on, where an email identified as spam would be processed in an infinite loop.</li>
<li>Added the "direct_mailbox_rewrite" and "direct_mailbox_scan" configuration options, and removed the "direct_mailbox_passthrough" configuration option. This allow for more flexibility when determining the scanning policy for direct mailbox addresses. The default settings are to not rewrite direct mailbox addresses, and to not scan mail for direct mailbox addresses.</li>
</ul>
</dd>
<dt><a href="http://www.tffenterprises.com/cgpsa/releases/cgpsa-1_0_3.tgz">1.0.3</a> - 30 March 2003</dt>
<dd>
<p>Changes</p>
<ul>
<li>Added the "parallel_requests" setting, which defaults to "false". This addresses problems on Win32, and potentially on other platforms as well, with the mechanism currently used to process multiple emails in parallel.</li>
<li>Changed the default settings for "use_user_prefs", "require_user_prefs", and "use_user_state" to "no".</li>
<li>Removed OS name and Perl version from X-TFF-CGPSA-Version header.</li>
<li>Added clarification in the configuration file that the default home directory setting should not be quoted.</li>
</ul>
<p>Bug Fixes</p>
<ul>
<li>Fixed a problem where the "headers_only" setting was not read properly.</li>
<li>Fixed a problem where, if there was no default SpamAssassin preferences file and user preferences were not being used, no mail would be scanned.</li>
</ul>
</dd>
<dt><a href="http://www.tffenterprises.com/cgpsa/releases/cgpsa-1_0_2.tgz">1.0.2</a> - 27 March 2003</dt>
<dd>
<p>Bug Fixes</p>
<ul>
<li>Fixed a problem where the CGP CLI module wouldn't load properly if it wasn't found as "CGP/CLI.pm".</li>
<li>Fixed a problem where, under certain circumstances, Perl's Taint Mode (security infrastructure) prevented CGPSA from removing some temporary files used in SpamAssassin initialization.</li>
<li>Fixed a non sequitur in the documentation.</li>
</ul>
</dd>
<dt><a href="http://www.tffenterprises.com/cgpsa/releases/cgpsa-1_0_1.tgz">1.0.1</a> - 27 March 2003</dt>
<dd>
<p>Changes</p>
<ul>
<li>Added the "install CGP::CLI" step to the installation instructions.</li>
<li>Added runtime check for CGP::CLI module, so that it need not be
installed if CGPSA is running with "use_cli" set to false (or in headers-only mode). The module can be installed as <code>CGP/CLI.pm</code> or just <code>CLI.pm</code>.</li>
</ul>
</dd>
<dt><a href="http://www.tffenterprises.com/cgpsa/releases/cgpsa-1_0.tgz">1.0</a> - 23 March 2003</dt>
<dd>
<ul>
<li>Initial release version.</li>
</ul>
</dd>
</dl>

<hr/>

<h3 id="future">Future Plans</h3>

<p>I'd like a better name to replace "CGPSA". If
anybody has any suggestions, I'd really appreciate hearing them...</p>

<p>A hypothetical future version of CGPSA will have a user interface
to support individual auto-whitelists, Bayes databases, and
SpamAssassin preferences for CommuniGate users. This hypothetical
version of CGPSA will also be refactored to be somewhat more
object-oriented and modular (because 1000-line Perl scripts are not
the easiest things in the world to maintain).</p>

<hr/>

<h3 id="legal">Legal Stuff</h3>

<p>CommuniGate is a registered trademark of Stalker Software, Inc. SpamAssassin is a registered trademark of Deersoft, Inc.</p>

<hr/>

<address><a
href="http://validator.w3.org/check/referer"><img
src="http://www.w3.org/Icons/valid-xhtml11" alt="Valid XHTML 1.1!"
height="31" width="88" /></a> Last modified by <a
href="http://www.tffenterprises.com/~dmz/">Daniel M. Zimmerman</a> on 
14 November 2003<br />
</address>
</body>
</html>
